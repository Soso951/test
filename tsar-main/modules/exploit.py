import streamlit as st
import subprocess, shlex

SEARCH = "searchsploit -w --json {q}"

def _searchsploit(q: str):
    cmd = SEARCH.format(q=shlex.quote(q))
    try: return subprocess.check_output(cmd, shell=True, text=True)
    except Exception as e: return str(e)

def render():
    st.header("ðŸ’£ Exploit Search")
    [tab] = st.tabs(["SearchSploit"])
    with tab:
        q = st.text_input("Query", placeholder="apache 2.4.56")
        if st.button("Search", key="exp_btn") and q:
            out = _searchsploit(q)
            st.session_state.results.setdefault("exploit",{})[q] = out
            st.text(out)